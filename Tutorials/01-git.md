# Utiliser Git avec Unity

# Table of Contents
1. [Introduction](#Introduction)
2. [Git-Setup](#Git-Setup)
3. [Unity Project Setup](#unity-Project-Setup)

## Introduction

Pour gérer les différentes versions d'un projet et ne jamais perdre son travail, le plus simple est d'utiliser Git.

### Historique

Git est un logiciel de gestion de versions décentralisé. C'est un logiciel libre créé par Linus Torvalds, auteur du noyau Linux, et distribué selon les termes de la licence publique générale GNU version 2. En 2016, il s’agit du logiciel de gestion de versions le plus populaire qui est utilisé par plus de douze millions de personnes 
(source wikipedia)

## Git Setup

### Install Git For Windows

#### Description
Git for Windows se concentre sur l'offre d'un ensemble d'outils légers et natifs qui apportent l'ensemble des fonctionnalités de Git à Windows tout en fournissant des interfaces utilisateur appropriées pour les utilisateurs expérimentés de Git comme pour les novices.

##### Git BASH
Git pour Windows fournit une émulation BASH utilisée pour exécuter Git à partir de la ligne de commande. *Les utilisateurs de UNIX devraient se sentir comme chez eux, car l'émulation BASH se comporte exactement comme la commande "git" dans les environnements LINUX et UNIX.

##### Interface graphique de Git
Comme les utilisateurs de Windows s'attendent généralement à des interfaces graphiques, Git for Windows fournit également l'interface graphique Git, une puissante alternative à Git BASH, offrant une version graphique de presque toutes les fonctions de la ligne de commande Git, ainsi que des outils de comparaison visuelle complets.

##### Intégration du shell
Il suffit de cliquer avec le bouton droit de la souris sur un dossier dans l'explorateur Windows pour accéder à la BASH ou à l'interface graphique.

#### install
Installer git via:
https://gitforwindows.org/

### install Git-LFS

#### description
Git Large File Storage (LFS) remplace les fichiers volumineux tels que les fichiers audio, les vidéos, les ensembles de données et les images par des pointeurs de texte dans Git, tout en stockant le contenu des fichiers sur un serveur distant comme GitHub.com ou GitHub Enterprise.

#### install

- Installer Git LFS via:
  https://git-lfs.github.com/
- taper la ligne de commande suivante dans git bash
``` git lfs install ```

### Merge des Scenes et des Prefab
Un problème courant lorsque vous travaillez avec Unity est lorsque 2 développeurs ou plus modifient une scène ou un préfabriqué Unity (fichiers * .unity). Git ne sait pas comment les fusionner correctement. Heureusement, l'équipe d'Unity a déployé un outil appelé [SmartMerge,](https://docs.unity3d.com/Manual/SmartMerge.html) qui permet de fusionner automatiquement les données. La première chose à faire est d'ajouter les lignes suivantes à votre fichier `.git` ou `.gitconfig` : (Windows: `%USERPROFILE%\.gitconfig` , Linux / Mac OS X: `~/.gitconfig` )

```
[merge]
tool = unityyamlmerge

[mergetool "unityyamlmerge"]
trustExitCode = false
cmd = '<path to UnityYAMLMerge>' merge -p "$BASE" "$REMOTE" "$LOCAL" "$MERGED"
```

Sous  **Windows,**  le chemin d'accès à UnityYAMLMerge est le suivant:
```
C:\Program Files\Unity\Editor\Data\Tools\UnityYAMLMerge.exe
```

ou

```
C:\Program Files (x86)\Unity\Editor\Data\Tools\UnityYAMLMerge.exe
```

Une fois cela fait, le mergetool sera disponible lorsque des conflits surviendront lors de la fusion / rebase. N'oubliez pas de lancer  `git mergetool`  manuellement pour déclencher UnityYAMLMerge.


## Unity Project Setup 

__!!! Attention !!!__
Ces étapes sont à refaire pour chaque projet

### ignorer les fichiers inutiles

Beaucoup de fichiers sont générés par unity et ne sont pas utiles (les librairies, les fichiers spécifiques à chaque collaborateur, etc) Il faut dire à Git de les ignorer. Pour cela vous pouvez ajouter le modèle ci-dessous à votre fichier `.gitignore` dans la racine de projet.

```
[Ll]ibrary/
[Tt]emp/
[Oo]bj/
[Bb]uild/
[Bb]uilds/
[Ll]ogs/
[Uu]ser[Ss]ettings/

# Uncomment this line if you wish to ignore the asset store tools plugin
# [Aa]ssets/AssetStoreTools*

# Visual Studio cache directory
.vs/

# Gradle cache directory
.gradle/

# Autogenerated VS/MD/Consulo solution and project files
ExportedObj/
.consulo/
*.csproj
*.unityproj
*.sln
*.suo
*.tmp
*.user
*.userprefs
*.pidb
*.booproj
*.svd
*.pdb
*.mdb
*.opendb
*.VC.db

# Unity3D generated meta files
*.pidb.meta
*.pdb.meta
*.mdb.meta

# Unity3D generated file on crash reports
sysinfo.txt

# Builds
*.apk
*.unitypackage

# Crashlytics generated file
crashlytics-build.properties

# Windows
Thumbs.db
Thumbs.db.meta

# MacOS
*.DS_Store

# VS Code
*.vscode
```
### Configuration de Git LFS

Si vous utilisez le plug-in Git LFS pour mieux prendre en charge les fichiers binaires, vous devrez définir certains types de fichiers à gérer par Git LFS. Ajoutez ce qui suit à votre fichier `.gitattributes` à la racine de votre Projet pour prendre en charge les fichiers binaires courants utilisés par Unity:
```
* text=auto

# Unity files
*.meta -text merge=unityyamlmerge diff
*.unity -text merge=unityyamlmerge diff
*.asset -text merge=unityyamlmerge diff
*.prefab -text merge=unityyamlmerge diff
*.mat -text merge=unityyamlmerge diff
*.anim -text merge=unityyamlmerge diff
*.controller -text merge=unityyamlmerge diff
*.overrideController -text merge=unityyamlmerge diff
*.physicMaterial -text merge=unityyamlmerge diff
*.physicsMaterial2D -text merge=unityyamlmerge diff
*.playable -text merge=unityyamlmerge diff
*.mask -text merge=unityyamlmerge diff
*.brush -text merge=unityyamlmerge diff
*.flare -text merge=unityyamlmerge diff
*.fontsettings -text merge=unityyamlmerge diff
*.guiskin -text merge=unityyamlmerge diff
*.giparams -text merge=unityyamlmerge diff
*.renderTexture -text merge=unityyamlmerge diff
*.spriteatlas -text merge=unityyamlmerge diff
*.terrainlayer -text merge=unityyamlmerge diff
*.mixer -text merge=unityyamlmerge diff
*.shadervariants -text merge=unityyamlmerge diff

# Image formats
*.psd filter=lfs diff=lfs merge=lfs -text
*.jpg filter=lfs diff=lfs merge=lfs -text
*.png filter=lfs diff=lfs merge=lfs -text
*.gif filter=lfs diff=lfs merge=lfs -text
*.bmp filter=lfs diff=lfs merge=lfs -text
*.tga filter=lfs diff=lfs merge=lfs -text
*.tiff filter=lfs diff=lfs merge=lfs -text
*.tif filter=lfs diff=lfs merge=lfs -text
*.iff filter=lfs diff=lfs merge=lfs -text
*.pict filter=lfs diff=lfs merge=lfs -text
*.dds filter=lfs diff=lfs merge=lfs -text
*.xcf filter=lfs diff=lfs merge=lfs -text

# Audio formats
*.mp3 filter=lfs diff=lfs merge=lfs -text
*.ogg filter=lfs diff=lfs merge=lfs -text
*.wav filter=lfs diff=lfs merge=lfs -text
*.aiff filter=lfs diff=lfs merge=lfs -text
*.aif filter=lfs diff=lfs merge=lfs -text
*.mod filter=lfs diff=lfs merge=lfs -text
*.it filter=lfs diff=lfs merge=lfs -text
*.s3m filter=lfs diff=lfs merge=lfs -text
*.xm filter=lfs diff=lfs merge=lfs -text

# Video formats
*.mov filter=lfs diff=lfs merge=lfs -text
*.avi filter=lfs diff=lfs merge=lfs -text
*.asf filter=lfs diff=lfs merge=lfs -text
*.mpg filter=lfs diff=lfs merge=lfs -text
*.mpeg filter=lfs diff=lfs merge=lfs -text
*.mp4 filter=lfs diff=lfs merge=lfs -text

# 3D formats
*.fbx filter=lfs diff=lfs merge=lfs -text
*.obj filter=lfs diff=lfs merge=lfs -text
*.max filter=lfs diff=lfs merge=lfs -text
*.blend filter=lfs diff=lfs merge=lfs -text
*.dae filter=lfs diff=lfs merge=lfs -text
*.mb filter=lfs diff=lfs merge=lfs -text
*.ma filter=lfs diff=lfs merge=lfs -text
*.3ds filter=lfs diff=lfs merge=lfs -text
*.dfx filter=lfs diff=lfs merge=lfs -text
*.c4d filter=lfs diff=lfs merge=lfs -text
*.lwo filter=lfs diff=lfs merge=lfs -text
*.lwo2 filter=lfs diff=lfs merge=lfs -text
*.abc filter=lfs diff=lfs merge=lfs -text
*.3dm filter=lfs diff=lfs merge=lfs -text

# Build
*.dll filter=lfs diff=lfs merge=lfs -text
*.pdb filter=lfs diff=lfs merge=lfs -text
*.mdb filter=lfs diff=lfs merge=lfs -text

# Packaging
*.zip filter=lfs diff=lfs merge=lfs -text
*.7z filter=lfs diff=lfs merge=lfs -text
*.gz filter=lfs diff=lfs merge=lfs -text
*.rar filter=lfs diff=lfs merge=lfs -text
*.tar filter=lfs diff=lfs merge=lfs -text
```